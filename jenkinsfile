pipeline{
    agent{
      label 'AGENT-1'
    }
    options{

        timeout(time:2, unit: 'MINUTES')
        disableConcurrentBuilds()
        ansiColor('xterm')
    }
    
        stages{
             stage('Init'){
              steps{  
                sh """
                  cd 01-vpc
                  terrafrom init -reconfigure

                """
              }
             }  
            stage('Plan'){
              steps{  
                sh '''
                  cd 01-vpc
                  terraform plan
                '''
              }
           
            }
        
            stage('Deploy'){

                input {
                message "Should we continue?"
                ok "Yes, Continue."
                }
                steps{
                 sh '''
                  cd 01-vpc
                  terraform apply auto-approve
                ''' 
                }
                
            }
           
            }
             post{
              always{
                  deleteDir()
              }

    }
    
        }

